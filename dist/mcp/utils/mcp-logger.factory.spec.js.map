{"version":3,"file":"mcp-logger.factory.spec.js","sourceRoot":"","sources":["../../../src/mcp/utils/mcp-logger.factory.spec.ts"],"names":[],"mappings":"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","sourcesContent":["import { Logger } from '@nestjs/common';\nimport { createMcpLogger } from './mcp-logger.factory';\nimport type { McpOptions } from '../interfaces';\n\ndescribe('McpLoggerFactory', () => {\n  describe('createMcpLogger', () => {\n    it('should create standard logger when no options provided', () => {\n      const logger = createMcpLogger('TestContext', undefined);\n      expect(logger).toBeInstanceOf(Logger);\n    });\n\n    it('should create standard logger when logging is undefined', () => {\n      const options: McpOptions = {\n        name: 'test',\n        version: '1.0.0',\n        // logging is undefined\n      };\n      const logger = createMcpLogger('TestContext', options);\n      expect(logger).toBeInstanceOf(Logger);\n    });\n\n    it('should create no-op logger when logging is false', () => {\n      const options: McpOptions = {\n        name: 'test',\n        version: '1.0.0',\n        logging: false,\n      };\n      const logger = createMcpLogger('TestContext', options);\n      expect(logger).toBeInstanceOf(Logger);\n\n      // Verify that log methods don't throw and don't produce output\n      expect(() => {\n        logger.log('test message');\n        logger.error('test error');\n        logger.warn('test warning');\n        logger.debug('test debug');\n        logger.verbose('test verbose');\n      }).not.toThrow();\n    });\n\n    it('should create filtered logger with specified levels', () => {\n      const options: McpOptions = {\n        name: 'test',\n        version: '1.0.0',\n        logging: {\n          level: ['error', 'warn'],\n        },\n      };\n      const logger = createMcpLogger('TestContext', options);\n      expect(logger).toBeInstanceOf(Logger);\n\n      // Verify that log methods don't throw\n      expect(() => {\n        logger.log('test message');\n        logger.error('test error');\n        logger.warn('test warning');\n        logger.debug('test debug');\n        logger.verbose('test verbose');\n      }).not.toThrow();\n    });\n\n    it('should create logger with all log levels when specified', () => {\n      const options: McpOptions = {\n        name: 'test',\n        version: '1.0.0',\n        logging: {\n          level: ['log', 'error', 'warn', 'debug', 'verbose'],\n        },\n      };\n      const logger = createMcpLogger('TestContext', options);\n      expect(logger).toBeInstanceOf(Logger);\n    });\n\n    it('should handle empty level array gracefully', () => {\n      const options: McpOptions = {\n        name: 'test',\n        version: '1.0.0',\n        logging: {\n          level: [],\n        },\n      };\n      const logger = createMcpLogger('TestContext', options);\n      expect(logger).toBeInstanceOf(Logger);\n\n      // With empty levels, nothing should be logged\n      expect(() => {\n        logger.log('test message');\n        logger.error('test error');\n        logger.warn('test warning');\n        logger.debug('test debug');\n        logger.verbose('test verbose');\n      }).not.toThrow();\n    });\n  });\n\n  describe('FilteredLogger behavior', () => {\n    it('should only call parent logger methods for enabled levels', () => {\n      const options: McpOptions = {\n        name: 'test',\n        version: '1.0.0',\n        logging: {\n          level: ['error', 'warn'],\n        },\n      };\n\n      // Mock the Logger prototype methods\n      const logSpy = jest.spyOn(Logger.prototype, 'log').mockImplementation();\n      const errorSpy = jest\n        .spyOn(Logger.prototype, 'error')\n        .mockImplementation();\n      const warnSpy = jest.spyOn(Logger.prototype, 'warn').mockImplementation();\n      const debugSpy = jest\n        .spyOn(Logger.prototype, 'debug')\n        .mockImplementation();\n      const verboseSpy = jest\n        .spyOn(Logger.prototype, 'verbose')\n        .mockImplementation();\n\n      const logger = createMcpLogger('TestContext', options);\n\n      // Call all methods\n      logger.log('log message');\n      logger.error('error message');\n      logger.warn('warn message');\n      logger.debug('debug message');\n      logger.verbose('verbose message');\n\n      // Only error and warn should have been called on the parent\n      // Note: The constructor call also invokes these, so we check if they were called\n      expect(errorSpy).toHaveBeenCalled();\n      expect(warnSpy).toHaveBeenCalled();\n\n      // Clean up\n      logSpy.mockRestore();\n      errorSpy.mockRestore();\n      warnSpy.mockRestore();\n      debugSpy.mockRestore();\n      verboseSpy.mockRestore();\n    });\n  });\n\n  describe('NoOpLogger behavior', () => {\n    it('should not call parent logger methods when logging is disabled', () => {\n      const options: McpOptions = {\n        name: 'test',\n        version: '1.0.0',\n        logging: false,\n      };\n\n      // Mock the Logger prototype methods\n      const logSpy = jest.spyOn(Logger.prototype, 'log').mockImplementation();\n      const errorSpy = jest\n        .spyOn(Logger.prototype, 'error')\n        .mockImplementation();\n      const warnSpy = jest.spyOn(Logger.prototype, 'warn').mockImplementation();\n      const debugSpy = jest\n        .spyOn(Logger.prototype, 'debug')\n        .mockImplementation();\n      const verboseSpy = jest\n        .spyOn(Logger.prototype, 'verbose')\n        .mockImplementation();\n\n      const logger = createMcpLogger('TestContext', options);\n\n      // Call all methods\n      logger.log('log message');\n      logger.error('error message');\n      logger.warn('warn message');\n      logger.debug('debug message');\n      logger.verbose('verbose message');\n\n      // Clean up\n      logSpy.mockRestore();\n      errorSpy.mockRestore();\n      warnSpy.mockRestore();\n      debugSpy.mockRestore();\n      verboseSpy.mockRestore();\n    });\n  });\n});\n"]}